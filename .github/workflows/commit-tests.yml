name: Commit Tests
on: push
jobs:
  cypress:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout app repo
        uses: actions/checkout@v3
        with:
          path: lexurgy-app
      - name: Checkout services repo
        uses: actions/checkout@v3
        with:
          repository: def-gthill/lexurgy
          ref: api
          path: lexurgy
      - name: Set up Gradle
        uses: gradle/gradle-build-action@v2
      - name: Build server
        run: ./lexurgy/gradlew :api:stage
      - name: Start server
        uses: isbang/compose-action@v1.5.1
        with:
          compose-file: lexurgy-app/docker-compose.yml
